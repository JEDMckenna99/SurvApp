# SURV - Field Service Management Platform
## Complete Development Plan & Architecture

*In-house HouseCall Pro alternative for Surv*  
*Technology Stack: React, Python, Heroku, PostgreSQL*

---

## Table of Contents
1. [Executive Overview](#executive-overview)
2. [Technology Stack](#technology-stack)
3. [Development Phases](#development-phases)
4. [Core Feature Modules](#core-feature-modules)
5. [Database Architecture](#database-architecture)
6. [API Requirements](#api-requirements)
7. [Frontend Architecture](#frontend-architecture)
8. [Backend Architecture](#backend-architecture)
9. [Timeline & Resource Allocation](#timeline--resource-allocation)
10. [Security & Compliance](#security--compliance)

---

## Executive Overview

### Project Goal
Build a comprehensive field service management platform for Surv that replicates HouseCall Pro's functionality with custom branding and in-house control.

### Key Differentiators
- Full data ownership and control
- Custom workflow capabilities
- Direct integration with Surv's existing systems
- No per-user licensing fees
- Customizable to specific business needs

### Success Metrics
- Replace existing scheduling/dispatch systems
- Reduce administrative overhead by 40%
- Improve technician utilization by 25%
- Increase customer satisfaction scores
- Complete digital transformation of field operations

---

## Technology Stack

### Frontend
- **Framework**: React 18+ with TypeScript
- **State Management**: Redux Toolkit + RTK Query
- **UI Components**: Material-UI (MUI) or Tailwind CSS + HeadlessUI
- **Mobile**: React Native (code sharing with web)
- **Form Management**: React Hook Form + Zod validation
- **Date/Time**: date-fns or Day.js
- **Maps**: Mapbox GL JS or Google Maps API
- **Charts**: Recharts or Chart.js
- **Real-time**: Socket.io client

### Backend
- **Language**: Python 3.11+
- **Framework**: FastAPI (async, high performance)
- **ORM**: SQLAlchemy 2.0 with async support
- **Task Queue**: Celery + Redis
- **WebSocket**: FastAPI WebSockets or Socket.io
- **Authentication**: JWT tokens + OAuth2
- **File Storage**: AWS S3 or Cloudinary
- **Email**: SendGrid or AWS SES
- **SMS**: Twilio

### Database & Infrastructure
- **Primary Database**: Heroku PostgreSQL
- **Cache**: Redis (Heroku Redis)
- **File Storage**: AWS S3 or Heroku-compatible storage
- **Hosting**: Heroku (web dynos + worker dynos)
- **CDN**: Cloudflare or AWS CloudFront
- **Monitoring**: Sentry + Heroku metrics

### Development Tools
- **Version Control**: Git + GitHub
- **CI/CD**: GitHub Actions + Heroku Pipelines
- **API Documentation**: Swagger/OpenAPI (auto-generated by FastAPI)
- **Testing**: Jest + React Testing Library (frontend), Pytest (backend)
- **Code Quality**: ESLint, Prettier, Black, MyPy

---

## Development Phases

### Phase 1: Core Foundation (Weeks 1-6)
**Priority: MVP for internal operations**

#### 1.1 Authentication & User Management
- User registration and login
- Role-based access control (Admin, Manager, Technician, Customer)
- JWT token authentication
- Password reset functionality
- User profiles and settings

#### 1.2 Customer Management (CRM)
- Customer profiles with contact information
- Multiple property locations per customer
- Customer notes and tags
- Job history tracking
- Custom fields for customer data

#### 1.3 Basic Job Scheduling
- Create and edit jobs
- Assign jobs to technicians
- Set job dates and time windows
- Job status tracking (Scheduled, In Progress, Completed, Cancelled)
- Calendar view (day, week, month)

#### 1.4 Basic Invoicing
- Create invoices for completed jobs
- Line items with descriptions and prices
- Calculate totals and taxes
- Send invoices via email
- Mark invoices as paid/unpaid

**Deliverables:**
- Working authentication system
- Basic CRM functionality
- Simple scheduling interface
- Invoice generation and tracking

---

### Phase 2: Enhanced Scheduling & Field Operations (Weeks 7-12)

#### 2.1 Advanced Scheduling Features
- Drag-and-drop calendar interface
- Recurring job templates
- Multi-day jobs
- Job priority levels
- Conflict detection
- Availability management

#### 2.2 Real-Time Dispatching
- Push notifications to technician mobile app
- Job assignment notifications
- Real-time job updates
- Emergency/priority dispatch
- Batch dispatch operations

#### 2.3 Mobile Application (Technician App)
- React Native iOS/Android app
- View assigned jobs for the day
- Job details and customer information
- GPS navigation to job site
- Clock in/out functionality
- Offline mode with sync

#### 2.4 Estimates & Proposals
- Create and send estimates
- Template-based estimates
- Auto-conversion of approved estimates to jobs
- Track estimate status
- Digital signatures for approval

**Deliverables:**
- Advanced scheduling system
- Real-time dispatch functionality
- Mobile app for technicians (MVP)
- Estimate management

---

### Phase 3: Payments & Financial Management (Weeks 13-18)

#### 3.1 Payment Processing
- Credit card processing integration
- ACH/bank transfer payments
- Cash and check recording
- Payment method management
- Refund processing

#### 3.2 Advanced Invoicing
- Customizable invoice templates
- Automated payment reminders
- Recurring invoices
- Partial payments
- Late fees automation

#### 3.3 Financial Reporting
- Revenue reports
- Accounts receivable aging
- Payment method breakdown
- Tax reporting
- Job profitability analysis

#### 3.4 Job Costing
- Track material costs per job
- Labor cost tracking
- Estimated vs. actual cost comparison
- Profit margin calculations

**Deliverables:**
- Complete payment processing system
- Advanced invoicing features
- Financial reporting dashboard
- Job costing tools

---

### Phase 4: Communication & Marketing (Weeks 19-24)

#### 4.1 Customer Communication
- Automated SMS notifications
- Email templates and automation
- Two-way text messaging
- Job confirmation messages
- Technician en route notifications

#### 4.2 Marketing Automation
- Email campaign builder
- Automated follow-up sequences
- Customer segmentation
- Campaign ROI tracking
- Review request automation

#### 4.3 Online Booking System
- Public booking page
- Real-time availability checking
- Service catalog display
- Booking confirmation automation
- Integration with main calendar

#### 4.4 Review Management
- Request reviews post-job
- Track reviews from multiple platforms
- Review response management
- Review analytics

**Deliverables:**
- Automated communication system
- Marketing campaign tools
- Online booking functionality
- Review management system

---

### Phase 5: Reporting & Analytics (Weeks 25-28)

#### 5.1 Business Intelligence Dashboard
- Key performance indicators (KPIs)
- Revenue tracking
- Job completion rates
- Technician performance metrics
- Customer acquisition metrics

#### 5.2 Advanced Reporting
- Custom report builder
- Scheduled report delivery
- Export to PDF/Excel
- Data visualization
- Trend analysis

#### 5.3 Performance Analytics
- Technician utilization rates
- Average job duration
- Customer lifetime value
- Conversion rate tracking
- Profit margin by service type

**Deliverables:**
- Business intelligence dashboard
- Custom reporting engine
- Performance analytics tools

---

### Phase 6: Advanced Features & Employee Management (Weeks 29-34)

#### 6.1 Employee Management
- Time tracking (clock in/out)
- Break and travel time tracking
- Timesheet management
- Payroll reporting
- Performance reviews

#### 6.2 GPS & Route Optimization
- Real-time GPS tracking
- Route optimization algorithms
- Geofencing
- Mileage tracking
- ETA calculations for customers

#### 6.3 Inventory Management
- Parts and materials inventory
- Stock level tracking
- Reorder alerts
- Assign inventory to vehicles
- Inventory used per job

#### 6.4 Service Plans & Recurring Revenue
- Maintenance plan templates
- Recurring service scheduling
- Auto-billing for service plans
- Plan renewal reminders

**Deliverables:**
- Employee management system
- GPS tracking and routing
- Inventory management
- Recurring revenue features

---

### Phase 7: Integrations & Ecosystem (Weeks 35-40)

#### 7.1 Accounting Integration
- QuickBooks Online integration
- Xero integration
- Auto-sync invoices and payments
- Chart of accounts mapping
- Customer sync

#### 7.2 Communication Platform Integration
- VoIP integration
- Call recording
- SMS gateway integration
- Email service provider integration

#### 7.3 Third-Party Tools
- Zapier/Make.com webhooks
- API for custom integrations
- Payment gateway options
- Cloud storage integration

#### 7.4 Website Integration
- Embed booking widget
- Form submissions to CRM
- Lead tracking
- Analytics integration

**Deliverables:**
- QuickBooks/Xero integration
- Communication platform integrations
- Public API and webhooks
- Website integration tools

---

### Phase 8: Polish & Advanced Features (Weeks 41-48)

#### 8.1 Advanced Workflow Automation
- Custom workflow builder
- Automated task creation
- Conditional logic for automations
- Multi-step workflows

#### 8.2 Team Collaboration
- In-app messaging
- File sharing
- Team announcements
- Shift scheduling

#### 8.3 Customer Portal
- Customer login area
- View job history
- Access invoices and receipts
- Manage payment methods
- Self-service booking

#### 8.4 Mobile App Enhancement
- Offline functionality improvements
- Enhanced photo capture
- Digital forms
- E-signature collection

**Deliverables:**
- Workflow automation engine
- Team collaboration tools
- Customer self-service portal
- Enhanced mobile features

---

## Core Feature Modules

### Module 1: Authentication & Authorization

**Database Tables:**
- `users` - User accounts
- `roles` - Role definitions
- `permissions` - Permission definitions
- `user_roles` - User-role assignments
- `password_resets` - Password reset tokens
- `api_tokens` - API authentication tokens

**API Endpoints:**
- `POST /api/auth/register` - User registration
- `POST /api/auth/login` - User login
- `POST /api/auth/logout` - User logout
- `POST /api/auth/refresh` - Refresh JWT token
- `POST /api/auth/forgot-password` - Request password reset
- `POST /api/auth/reset-password` - Reset password
- `GET /api/auth/me` - Get current user info

**Frontend Components:**
- LoginPage
- RegisterPage
- ForgotPasswordPage
- ResetPasswordPage
- UserProfilePage
- ProtectedRoute wrapper

---

### Module 2: Customer Management (CRM)

**Database Tables:**
- `customers` - Customer records
- `customer_properties` - Service locations
- `customer_contacts` - Additional contacts
- `customer_notes` - Notes and communications
- `customer_tags` - Tagging system
- `customer_files` - Document attachments

**API Endpoints:**
- `GET /api/customers` - List customers (paginated, filtered)
- `POST /api/customers` - Create customer
- `GET /api/customers/:id` - Get customer details
- `PUT /api/customers/:id` - Update customer
- `DELETE /api/customers/:id` - Delete customer
- `GET /api/customers/:id/jobs` - Get customer job history
- `POST /api/customers/:id/notes` - Add note
- `GET /api/customers/:id/files` - List attachments
- `POST /api/customers/:id/files` - Upload file

**Frontend Components:**
- CustomerList
- CustomerDetails
- CustomerForm (Create/Edit)
- CustomerNotes
- CustomerJobHistory
- CustomerSearch

---

### Module 3: Job & Schedule Management

**Database Tables:**
- `jobs` - Job records
- `job_statuses` - Status definitions
- `job_types` - Service types
- `job_notes` - Job-specific notes
- `job_files` - Before/after photos, documents
- `job_history` - Audit trail
- `recurring_jobs` - Recurring job templates
- `job_assignments` - Technician assignments

**API Endpoints:**
- `GET /api/jobs` - List jobs (filtered by date, status, technician)
- `POST /api/jobs` - Create job
- `GET /api/jobs/:id` - Get job details
- `PUT /api/jobs/:id` - Update job
- `DELETE /api/jobs/:id` - Cancel job
- `POST /api/jobs/:id/assign` - Assign technician
- `POST /api/jobs/:id/status` - Update status
- `GET /api/jobs/:id/timeline` - Get job timeline/history
- `POST /api/jobs/:id/notes` - Add note
- `POST /api/jobs/:id/files` - Upload files
- `GET /api/schedule` - Get calendar view
- `POST /api/recurring-jobs` - Create recurring job

**Frontend Components:**
- ScheduleCalendar (day/week/month views)
- JobList
- JobDetails
- JobForm (Create/Edit)
- JobTimeline
- DragDropScheduler
- RecurringJobForm

---

### Module 4: Estimates & Quotes

**Database Tables:**
- `estimates` - Estimate records
- `estimate_line_items` - Line items
- `estimate_templates` - Reusable templates
- `price_book_items` - Service catalog
- `price_book_categories` - Service categories

**API Endpoints:**
- `GET /api/estimates` - List estimates
- `POST /api/estimates` - Create estimate
- `GET /api/estimates/:id` - Get estimate details
- `PUT /api/estimates/:id` - Update estimate
- `DELETE /api/estimates/:id` - Delete estimate
- `POST /api/estimates/:id/send` - Send to customer
- `POST /api/estimates/:id/approve` - Approve and convert to job
- `GET /api/price-book` - Get service catalog
- `POST /api/price-book/items` - Add catalog item

**Frontend Components:**
- EstimateList
- EstimateForm
- EstimatePreview
- PriceBookSelector
- EstimateTemplates

---

### Module 5: Invoicing & Payments

**Database Tables:**
- `invoices` - Invoice records
- `invoice_line_items` - Line items
- `invoice_payments` - Payment records
- `payment_methods` - Stored payment methods
- `payment_transactions` - Transaction log
- `invoice_reminders` - Payment reminder history

**API Endpoints:**
- `GET /api/invoices` - List invoices
- `POST /api/invoices` - Create invoice
- `GET /api/invoices/:id` - Get invoice details
- `PUT /api/invoices/:id` - Update invoice
- `DELETE /api/invoices/:id` - Void invoice
- `POST /api/invoices/:id/send` - Email invoice
- `POST /api/invoices/:id/payments` - Record payment
- `GET /api/invoices/:id/pdf` - Generate PDF
- `POST /api/payments/process` - Process credit card payment
- `GET /api/payment-methods` - List payment methods

**Frontend Components:**
- InvoiceList
- InvoiceForm
- InvoicePreview
- PaymentForm
- PaymentMethodManager
- InvoicePaymentHistory

---

### Module 6: Communication

**Database Tables:**
- `sms_messages` - SMS log
- `email_messages` - Email log
- `notifications` - In-app notifications
- `communication_templates` - Message templates
- `email_campaigns` - Marketing campaigns
- `campaign_sends` - Campaign delivery log

**API Endpoints:**
- `POST /api/communications/sms` - Send SMS
- `POST /api/communications/email` - Send email
- `GET /api/communications/history/:customerId` - Communication history
- `GET /api/notifications` - Get user notifications
- `PUT /api/notifications/:id/read` - Mark as read
- `GET /api/templates` - List templates
- `POST /api/campaigns` - Create campaign
- `POST /api/campaigns/:id/send` - Send campaign

**Frontend Components:**
- SMSComposer
- EmailComposer
- TemplateManager
- NotificationCenter
- CampaignBuilder
- CommunicationHistory

---

### Module 7: Reporting & Analytics

**Database Tables:**
- `reports` - Saved reports
- `report_schedules` - Scheduled reports
- `dashboard_widgets` - Custom dashboard configs

**API Endpoints:**
- `GET /api/reports/revenue` - Revenue reports
- `GET /api/reports/jobs` - Job statistics
- `GET /api/reports/technicians` - Technician performance
- `GET /api/reports/customers` - Customer analytics
- `GET /api/dashboard/kpis` - Key performance indicators
- `POST /api/reports/custom` - Generate custom report
- `POST /api/reports/export` - Export report data

**Frontend Components:**
- DashboardHome
- ReportBuilder
- RevenueCharts
- PerformanceMetrics
- CustomReportGenerator
- ExportDialog

---

### Module 8: Employee Management

**Database Tables:**
- `employees` - Employee records
- `time_entries` - Clock in/out records
- `employee_schedules` - Shift schedules
- `time_off_requests` - PTO tracking
- `employee_certifications` - Skills and certs

**API Endpoints:**
- `GET /api/employees` - List employees
- `POST /api/employees` - Create employee
- `GET /api/employees/:id` - Get employee details
- `PUT /api/employees/:id` - Update employee
- `POST /api/time-entries` - Clock in/out
- `GET /api/time-entries/:employeeId` - Get timesheet
- `GET /api/schedules` - Get shift schedule

**Frontend Components:**
- EmployeeList
- EmployeeForm
- TimeTracking
- ScheduleManager
- TimesheetView

---

### Module 9: GPS & Route Optimization

**Database Tables:**
- `vehicle_locations` - GPS tracking history
- `routes` - Optimized routes
- `geofences` - Service areas
- `mileage_logs` - Mileage tracking

**API Endpoints:**
- `POST /api/gps/location` - Update location
- `GET /api/gps/tracking/:employeeId` - Real-time tracking
- `POST /api/routes/optimize` - Calculate optimal route
- `GET /api/routes/:id` - Get route details
- `POST /api/mileage/log` - Log mileage

**Frontend Components:**
- LiveMapView
- RouteOptimizer
- GeofenceManager
- MileageTracker

---

### Module 10: Online Booking

**Database Tables:**
- `booking_pages` - Public booking page configs
- `booking_availability` - Available time slots
- `booking_requests` - Customer booking requests
- `booking_form_fields` - Custom form fields

**API Endpoints:**
- `GET /api/booking/availability` - Check available slots
- `POST /api/booking/request` - Submit booking
- `GET /api/booking/config` - Get booking page config
- `PUT /api/booking/config` - Update settings

**Frontend Components:**
- BookingWidget (embeddable)
- BookingPage (public)
- AvailabilityCalendar
- BookingFormBuilder
- BookingRequestManager

---

## Database Architecture

### Core Database Schema

```sql
-- Users & Authentication
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    phone VARCHAR(20),
    role VARCHAR(50) NOT NULL, -- admin, manager, technician, customer
    is_active BOOLEAN DEFAULT true,
    email_verified BOOLEAN DEFAULT false,
    last_login TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_role ON users(role);

-- Customers
CREATE TABLE customers (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    email VARCHAR(255),
    phone VARCHAR(20),
    mobile VARCHAR(20),
    company_name VARCHAR(255),
    customer_type VARCHAR(50), -- residential, commercial
    status VARCHAR(50) DEFAULT 'active', -- active, inactive, archived
    tags TEXT[], -- Array of tags
    notes TEXT,
    created_by UUID REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_customers_email ON customers(email);
CREATE INDEX idx_customers_phone ON customers(phone);
CREATE INDEX idx_customers_status ON customers(status);
CREATE INDEX idx_customers_tags ON customers USING gin(tags);

-- Customer Properties/Locations
CREATE TABLE customer_properties (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    customer_id UUID REFERENCES customers(id) ON DELETE CASCADE,
    property_name VARCHAR(255),
    address_line1 VARCHAR(255) NOT NULL,
    address_line2 VARCHAR(255),
    city VARCHAR(100) NOT NULL,
    state VARCHAR(50) NOT NULL,
    zip_code VARCHAR(20) NOT NULL,
    country VARCHAR(50) DEFAULT 'USA',
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    is_primary BOOLEAN DEFAULT false,
    property_type VARCHAR(50), -- house, apartment, commercial
    access_notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_properties_customer ON customer_properties(customer_id);
CREATE INDEX idx_properties_location ON customer_properties USING gist(point(latitude, longitude));

-- Jobs
CREATE TABLE jobs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    job_number VARCHAR(50) UNIQUE NOT NULL,
    customer_id UUID REFERENCES customers(id),
    property_id UUID REFERENCES customer_properties(id),
    job_type VARCHAR(100) NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status VARCHAR(50) DEFAULT 'scheduled', -- scheduled, en_route, in_progress, completed, cancelled
    priority VARCHAR(20) DEFAULT 'normal', -- low, normal, high, urgent
    scheduled_date DATE NOT NULL,
    scheduled_start_time TIME,
    scheduled_end_time TIME,
    actual_start_time TIMESTAMP,
    actual_end_time TIMESTAMP,
    estimated_duration INTEGER, -- minutes
    assigned_to UUID REFERENCES users(id), -- Technician
    created_by UUID REFERENCES users(id),
    tags TEXT[],
    custom_fields JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_jobs_customer ON jobs(customer_id);
CREATE INDEX idx_jobs_assigned ON jobs(assigned_to);
CREATE INDEX idx_jobs_status ON jobs(status);
CREATE INDEX idx_jobs_date ON jobs(scheduled_date);
CREATE INDEX idx_jobs_number ON jobs(job_number);

-- Job History/Timeline
CREATE TABLE job_history (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    job_id UUID REFERENCES jobs(id) ON DELETE CASCADE,
    user_id UUID REFERENCES users(id),
    action VARCHAR(100) NOT NULL, -- created, assigned, status_changed, etc.
    old_value TEXT,
    new_value TEXT,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_job_history_job ON job_history(job_id);

-- Estimates
CREATE TABLE estimates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    estimate_number VARCHAR(50) UNIQUE NOT NULL,
    customer_id UUID REFERENCES customers(id),
    property_id UUID REFERENCES customer_properties(id),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status VARCHAR(50) DEFAULT 'draft', -- draft, sent, viewed, approved, declined, expired
    valid_until DATE,
    subtotal DECIMAL(10, 2) DEFAULT 0,
    tax_rate DECIMAL(5, 4) DEFAULT 0,
    tax_amount DECIMAL(10, 2) DEFAULT 0,
    discount_amount DECIMAL(10, 2) DEFAULT 0,
    total_amount DECIMAL(10, 2) DEFAULT 0,
    terms TEXT,
    notes TEXT,
    created_by UUID REFERENCES users(id),
    approved_at TIMESTAMP,
    converted_to_job_id UUID REFERENCES jobs(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_estimates_customer ON estimates(customer_id);
CREATE INDEX idx_estimates_status ON estimates(status);
CREATE INDEX idx_estimates_number ON estimates(estimate_number);

-- Estimate Line Items
CREATE TABLE estimate_line_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    estimate_id UUID REFERENCES estimates(id) ON DELETE CASCADE,
    item_name VARCHAR(255) NOT NULL,
    description TEXT,
    quantity DECIMAL(10, 2) NOT NULL,
    unit_price DECIMAL(10, 2) NOT NULL,
    total_price DECIMAL(10, 2) NOT NULL,
    sort_order INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_estimate_items_estimate ON estimate_line_items(estimate_id);

-- Invoices
CREATE TABLE invoices (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    invoice_number VARCHAR(50) UNIQUE NOT NULL,
    customer_id UUID REFERENCES customers(id),
    job_id UUID REFERENCES jobs(id),
    status VARCHAR(50) DEFAULT 'draft', -- draft, sent, viewed, partial, paid, overdue, void
    issue_date DATE NOT NULL,
    due_date DATE NOT NULL,
    subtotal DECIMAL(10, 2) DEFAULT 0,
    tax_rate DECIMAL(5, 4) DEFAULT 0,
    tax_amount DECIMAL(10, 2) DEFAULT 0,
    discount_amount DECIMAL(10, 2) DEFAULT 0,
    total_amount DECIMAL(10, 2) DEFAULT 0,
    amount_paid DECIMAL(10, 2) DEFAULT 0,
    amount_due DECIMAL(10, 2) DEFAULT 0,
    terms TEXT,
    notes TEXT,
    created_by UUID REFERENCES users(id),
    sent_at TIMESTAMP,
    paid_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_invoices_customer ON invoices(customer_id);
CREATE INDEX idx_invoices_job ON invoices(job_id);
CREATE INDEX idx_invoices_status ON invoices(status);
CREATE INDEX idx_invoices_number ON invoices(invoice_number);
CREATE INDEX idx_invoices_due_date ON invoices(due_date);

-- Invoice Line Items
CREATE TABLE invoice_line_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    invoice_id UUID REFERENCES invoices(id) ON DELETE CASCADE,
    item_name VARCHAR(255) NOT NULL,
    description TEXT,
    quantity DECIMAL(10, 2) NOT NULL,
    unit_price DECIMAL(10, 2) NOT NULL,
    total_price DECIMAL(10, 2) NOT NULL,
    sort_order INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_invoice_items_invoice ON invoice_line_items(invoice_id);

-- Payments
CREATE TABLE payments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    payment_number VARCHAR(50) UNIQUE NOT NULL,
    invoice_id UUID REFERENCES invoices(id),
    customer_id UUID REFERENCES customers(id),
    amount DECIMAL(10, 2) NOT NULL,
    payment_method VARCHAR(50) NOT NULL, -- credit_card, ach, cash, check
    payment_status VARCHAR(50) DEFAULT 'pending', -- pending, completed, failed, refunded
    transaction_id VARCHAR(255), -- From payment gateway
    payment_gateway VARCHAR(50), -- stripe, square, etc.
    payment_date TIMESTAMP NOT NULL,
    processed_by UUID REFERENCES users(id),
    notes TEXT,
    metadata JSONB, -- Gateway-specific data
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_payments_invoice ON payments(invoice_id);
CREATE INDEX idx_payments_customer ON payments(customer_id);
CREATE INDEX idx_payments_date ON payments(payment_date);

-- Communication Log
CREATE TABLE communications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    type VARCHAR(50) NOT NULL, -- email, sms, call, note
    direction VARCHAR(20), -- inbound, outbound
    customer_id UUID REFERENCES customers(id),
    job_id UUID REFERENCES jobs(id),
    user_id UUID REFERENCES users(id),
    subject VARCHAR(255),
    message TEXT,
    status VARCHAR(50), -- sent, delivered, failed, read
    metadata JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_communications_customer ON communications(customer_id);
CREATE INDEX idx_communications_job ON communications(job_id);
CREATE INDEX idx_communications_type ON communications(type);

-- Employees
CREATE TABLE employees (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) UNIQUE,
    employee_number VARCHAR(50) UNIQUE,
    hire_date DATE,
    employment_type VARCHAR(50), -- full_time, part_time, contractor
    department VARCHAR(100),
    job_title VARCHAR(100),
    hourly_rate DECIMAL(10, 2),
    overtime_rate DECIMAL(10, 2),
    skills TEXT[],
    certifications TEXT[],
    emergency_contact_name VARCHAR(255),
    emergency_contact_phone VARCHAR(20),
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_employees_user ON employees(user_id);

-- Time Entries
CREATE TABLE time_entries (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    employee_id UUID REFERENCES employees(id),
    job_id UUID REFERENCES jobs(id),
    entry_type VARCHAR(50) NOT NULL, -- clock_in, clock_out, break_start, break_end
    entry_time TIMESTAMP NOT NULL,
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_time_entries_employee ON time_entries(employee_id);
CREATE INDEX idx_time_entries_job ON time_entries(job_id);
CREATE INDEX idx_time_entries_time ON time_entries(entry_time);

-- GPS Tracking
CREATE TABLE location_history (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    employee_id UUID REFERENCES employees(id),
    latitude DECIMAL(10, 8) NOT NULL,
    longitude DECIMAL(11, 8) NOT NULL,
    accuracy DECIMAL(10, 2),
    speed DECIMAL(10, 2),
    heading DECIMAL(5, 2),
    recorded_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_location_employee ON location_history(employee_id);
CREATE INDEX idx_location_time ON location_history(recorded_at);

-- Price Book
CREATE TABLE price_book_categories (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    description TEXT,
    parent_id UUID REFERENCES price_book_categories(id),
    sort_order INTEGER,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE price_book_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    category_id UUID REFERENCES price_book_categories(id),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    sku VARCHAR(100),
    unit_of_measure VARCHAR(50),
    unit_price DECIMAL(10, 2) NOT NULL,
    cost_price DECIMAL(10, 2),
    taxable BOOLEAN DEFAULT true,
    is_active BOOLEAN DEFAULT true,
    image_url VARCHAR(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_price_items_category ON price_book_items(category_id);

-- File Attachments
CREATE TABLE files (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    file_name VARCHAR(255) NOT NULL,
    file_size INTEGER,
    file_type VARCHAR(100),
    file_url VARCHAR(500) NOT NULL,
    storage_path VARCHAR(500),
    entity_type VARCHAR(50) NOT NULL, -- customer, job, invoice, etc.
    entity_id UUID NOT NULL,
    uploaded_by UUID REFERENCES users(id),
    description TEXT,
    tags TEXT[],
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_files_entity ON files(entity_type, entity_id);

-- Settings
CREATE TABLE settings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    setting_key VARCHAR(100) UNIQUE NOT NULL,
    setting_value JSONB NOT NULL,
    description TEXT,
    updated_by UUID REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Notifications
CREATE TABLE notifications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    type VARCHAR(50) NOT NULL,
    title VARCHAR(255) NOT NULL,
    message TEXT,
    action_url VARCHAR(500),
    is_read BOOLEAN DEFAULT false,
    read_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_notifications_user ON notifications(user_id);
CREATE INDEX idx_notifications_read ON notifications(is_read);
```

---

## API Requirements

### Third-Party APIs Needed

#### 1. Payment Processing
**Primary: Stripe**
- API: Stripe API v2023+
- Features Needed:
  - Payment intents for credit card processing
  - ACH/bank account payments
  - Customer management
  - Refunds and disputes
  - Webhooks for payment events
  - Payment method storage (tokenization)
- Alternative: Square, PayPal, Braintree
- Pricing: 2.9% + $0.30 per transaction

#### 2. SMS Communications
**Primary: Twilio**
- API: Twilio Programmable SMS
- Features Needed:
  - Send SMS messages
  - Receive SMS (two-way messaging)
  - Message status tracking
  - Phone number provisioning
  - SMS templates
- Alternative: Vonage (Nexmo), AWS SNS
- Pricing: $0.0075-$0.01 per message

#### 3. Email Service
**Primary: SendGrid**
- API: SendGrid v3 API
- Features Needed:
  - Transactional emails
  - Email templates
  - Bulk email sending
  - Email tracking (opens, clicks)
  - Unsubscribe management
  - Email validation
- Alternative: AWS SES, Mailgun, Postmark
- Pricing: Free tier (100 emails/day), then $15/month (40K emails)

#### 4. Maps & Geolocation
**Primary: Google Maps Platform**
- APIs Needed:
  - Maps JavaScript API (map display)
  - Geocoding API (address to coordinates)
  - Directions API (routing)
  - Distance Matrix API (travel time calculations)
  - Places API (address autocomplete)
- Alternative: Mapbox, HERE Maps
- Pricing: $200 free credit/month, then pay-as-you-go

**Route Optimization:**
- API: Google Maps Routes API or
- Alternative: RouteXL API, GraphHopper
- For advanced multi-stop optimization: OptimoRoute API

#### 5. VoIP & Phone System
**Primary: Twilio Voice**
- API: Twilio Programmable Voice
- Features Needed:
  - Make/receive calls
  - Call recording
  - Call forwarding
  - IVR (Interactive Voice Response)
  - Call tracking
  - Voicemail transcription
- Alternative: Plivo, Bandwidth, Vonage
- Pricing: $0.013-$0.085 per minute

#### 6. File Storage
**Primary: AWS S3**
- API: AWS S3 API
- Features Needed:
  - File upload/download
  - Pre-signed URLs
  - CDN integration (CloudFront)
  - Lifecycle policies
- Alternative: Cloudinary (for images), DigitalOcean Spaces
- Pricing: $0.023 per GB/month

#### 7. Accounting Integration
**Primary: QuickBooks Online**
- API: QuickBooks Online API v3
- Features Needed:
  - Create/update customers
  - Sync invoices
  - Record payments
  - Chart of accounts mapping
  - Tax rates
- OAuth 2.0 authentication required
- Alternative: Xero API, FreshBooks API

**Secondary: Xero**
- API: Xero Accounting API
- Similar features to QuickBooks
- OAuth 2.0 authentication

#### 8. Calendar Integration
**Optional but Recommended**
- Google Calendar API
- Microsoft Outlook Calendar API
- Features: Sync jobs to personal calendars

#### 9. Document Generation
**Primary: PDFShift or Docraptor**
- API: HTML to PDF conversion
- Alternative: WeasyPrint (Python library, self-hosted)
- Use for: Invoice PDFs, estimate PDFs, reports

#### 10. Push Notifications
**Primary: Firebase Cloud Messaging (FCM)**
- API: FCM API
- Features Needed:
  - Send push notifications to mobile apps
  - Topic-based messaging
  - Device token management
- Alternative: OneSignal, Pusher
- Pricing: Free

#### 11. Address Validation
**Primary: Google Address Validation API**
- API: Google Address Validation API
- Features: Validate and standardize addresses
- Alternative: SmartyStreets, USPS API (US only)

#### 12. Weather Data (Optional)
**For scheduling optimization**
- API: OpenWeatherMap API or Weather.gov (US only)
- Use for: Weather-based scheduling alerts

#### 13. Background Jobs & Task Queue
**Redis (Required for Celery)**
- Heroku Redis add-on
- Use for: Task queue, caching, real-time features

#### 14. Analytics (Optional)
**Frontend Analytics:**
- Google Analytics 4
- Mixpanel
- PostHog (open-source alternative)

**Backend Monitoring:**
- Sentry (error tracking)
- LogRocket (session replay)

#### 15. Automation & Integrations
**Primary: Zapier/Make.com Integration**
- Provide webhooks from Surv
- Enable customers to create custom integrations
- No direct API needed, just webhook support

---

## Frontend Architecture

### Project Structure
```
surv-frontend/
├── public/
│   ├── index.html
│   └── favicon.ico
├── src/
│   ├── api/
│   │   ├── client.ts              # Axios instance
│   │   ├── auth.ts               # Auth API calls
│   │   ├── customers.ts          # Customer API calls
│   │   ├── jobs.ts               # Job API calls
│   │   └── ...
│   ├── components/
│   │   ├── common/               # Reusable components
│   │   │   ├── Button/
│   │   │   ├── Input/
│   │   │   ├── Modal/
│   │   │   ├── Table/
│   │   │   └── ...
│   │   ├── layout/               # Layout components
│   │   │   ├── Header/
│   │   │   ├── Sidebar/
│   │   │   ├── Footer/
│   │   │   └── DashboardLayout/
│   │   ├── customers/            # Customer-specific components
│   │   ├── jobs/                 # Job-specific components
│   │   ├── schedule/             # Schedule components
│   │   └── ...
│   ├── features/                 # Redux slices
│   │   ├── auth/
│   │   ├── customers/
│   │   ├── jobs/
│   │   └── ...
│   ├── hooks/                    # Custom React hooks
│   │   ├── useAuth.ts
│   │   ├── useDebounce.ts
│   │   └── ...
│   ├── pages/                    # Page components
│   │   ├── auth/
│   │   │   ├── LoginPage.tsx
│   │   │   └── RegisterPage.tsx
│   │   ├── customers/
│   │   │   ├── CustomersPage.tsx
│   │   │   └── CustomerDetailPage.tsx
│   │   ├── schedule/
│   │   │   └── SchedulePage.tsx
│   │   └── ...
│   ├── routes/
│   │   ├── AppRoutes.tsx
│   │   └── ProtectedRoute.tsx
│   ├── store/
│   │   └── store.ts              # Redux store
│   ├── styles/
│   │   ├── theme.ts              # MUI theme or Tailwind config
│   │   └── globals.css
│   ├── types/
│   │   ├── customer.ts
│   │   ├── job.ts
│   │   └── ...
│   ├── utils/
│   │   ├── formatters.ts
│   │   ├── validators.ts
│   │   └── ...
│   ├── App.tsx
│   └── index.tsx
├── package.json
├── tsconfig.json
└── .env.example
```

### Key Frontend Libraries

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.16.0",
    "@reduxjs/toolkit": "^1.9.5",
    "react-redux": "^8.1.2",
    "axios": "^1.5.0",
    "@mui/material": "^5.14.0",
    "@mui/x-date-pickers": "^6.16.0",
    "@mui/x-data-grid": "^6.16.0",
    "@emotion/react": "^11.11.1",
    "@emotion/styled": "^11.11.0",
    "react-hook-form": "^7.46.0",
    "zod": "^3.22.0",
    "date-fns": "^2.30.0",
    "react-big-calendar": "^1.8.4",
    "mapbox-gl": "^2.15.0",
    "react-map-gl": "^7.1.6",
    "recharts": "^2.8.0",
    "socket.io-client": "^4.7.0",
    "react-dropzone": "^14.2.3",
    "react-toastify": "^9.1.3",
    "@stripe/react-stripe-js": "^2.3.0",
    "@stripe/stripe-js": "^2.1.0"
  }
}
```

---

## Backend Architecture

### Project Structure
```
surv-backend/
├── app/
│   ├── __init__.py
│   ├── main.py                   # FastAPI app initialization
│   ├── config.py                 # Configuration settings
│   ├── database.py               # Database connection
│   ├── dependencies.py           # Common dependencies
│   ├── api/
│   │   ├── __init__.py
│   │   ├── v1/
│   │   │   ├── __init__.py
│   │   │   ├── auth.py          # Auth endpoints
│   │   │   ├── customers.py     # Customer endpoints
│   │   │   ├── jobs.py          # Job endpoints
│   │   │   ├── invoices.py      # Invoice endpoints
│   │   │   └── ...
│   ├── models/
│   │   ├── __init__.py
│   │   ├── user.py              # SQLAlchemy models
│   │   ├── customer.py
│   │   ├── job.py
│   │   └── ...
│   ├── schemas/
│   │   ├── __init__.py
│   │   ├── user.py              # Pydantic schemas
│   │   ├── customer.py
│   │   ├── job.py
│   │   └── ...
│   ├── services/
│   │   ├── __init__.py
│   │   ├── auth_service.py      # Business logic
│   │   ├── customer_service.py
│   │   ├── job_service.py
│   │   ├── sms_service.py       # Twilio integration
│   │   ├── email_service.py     # SendGrid integration
│   │   ├── payment_service.py   # Stripe integration
│   │   └── ...
│   ├── tasks/
│   │   ├── __init__.py
│   │   ├── celery_app.py        # Celery configuration
│   │   ├── email_tasks.py       # Background email tasks
│   │   └── notification_tasks.py
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── security.py          # Password hashing, JWT
│   │   ├── validators.py
│   │   └── helpers.py
│   └── middleware/
│       ├── __init__.py
│       └── auth_middleware.py
├── migrations/                   # Alembic migrations
├── tests/
├── requirements.txt
├── Procfile                      # Heroku process file
├── runtime.txt                   # Python version
└── .env.example
```

### Key Backend Libraries

```txt
fastapi==0.103.0
uvicorn[standard]==0.23.2
sqlalchemy==2.0.20
alembic==1.11.3
psycopg2-binary==2.9.7
pydantic==2.3.0
pydantic-settings==2.0.3
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6
celery==5.3.1
redis==5.0.0
stripe==6.5.0
twilio==8.8.0
sendgrid==6.10.0
boto3==1.28.0
googlemaps==4.10.0
pyjwt==2.8.0
python-dotenv==1.0.0
httpx==0.24.1
sentry-sdk==1.30.0
```

### Heroku Configuration

**Procfile:**
```
web: uvicorn app.main:app --host 0.0.0.0 --port $PORT
worker: celery -A app.tasks.celery_app worker --loglevel=info
beat: celery -A app.tasks.celery_app beat --loglevel=info
```

**Required Heroku Add-ons:**
- Heroku Postgres (Standard tier or higher)
- Heroku Redis (Premium tier for production)
- Heroku Scheduler (for cron jobs)
- Papertrail or Logentries (logging)

**Environment Variables (Heroku Config Vars):**
```
DATABASE_URL=postgresql://...
REDIS_URL=redis://...
SECRET_KEY=your-secret-key
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=1440

# API Keys
STRIPE_SECRET_KEY=sk_...
STRIPE_PUBLISHABLE_KEY=pk_...
STRIPE_WEBHOOK_SECRET=whsec_...
TWILIO_ACCOUNT_SID=AC...
TWILIO_AUTH_TOKEN=...
TWILIO_PHONE_NUMBER=+1...
SENDGRID_API_KEY=SG...
SENDGRID_FROM_EMAIL=noreply@surv.com
GOOGLE_MAPS_API_KEY=AIza...
AWS_ACCESS_KEY_ID=...
AWS_SECRET_ACCESS_KEY=...
AWS_S3_BUCKET_NAME=surv-files
AWS_REGION=us-east-1

# App Config
FRONTEND_URL=https://app.surv.com
API_URL=https://api.surv.com
ENVIRONMENT=production
```

---

## Timeline & Resource Allocation

### Development Team Structure

**Recommended Team:**
- 1 Backend Developer (Python/FastAPI)
- 1 Frontend Developer (React/TypeScript)
- 1 Full-Stack Developer (can assist both sides)
- 1 Mobile Developer (React Native)
- 1 UI/UX Designer
- 1 QA Engineer
- 1 DevOps/Infrastructure Engineer (part-time)
- 1 Project Manager

**Minimum Viable Team:**
- 2 Full-Stack Developers
- 1 UI/UX Designer (part-time)

### Timeline Breakdown

**Total Estimated Time: 48 weeks (12 months) for full feature parity**

| Phase | Duration | Team Size | Focus |
|-------|----------|-----------|-------|
| Phase 1 | 6 weeks | 2-3 devs | Core Foundation |
| Phase 2 | 6 weeks | 3-4 devs | Scheduling & Mobile |
| Phase 3 | 6 weeks | 3-4 devs | Payments & Financial |
| Phase 4 | 6 weeks | 3-4 devs | Communications |
| Phase 5 | 4 weeks | 2-3 devs | Reporting |
| Phase 6 | 6 weeks | 3-4 devs | Advanced Features |
| Phase 7 | 6 weeks | 2-3 devs | Integrations |
| Phase 8 | 8 weeks | 3-4 devs | Polish & Enhancement |

**Accelerated Timeline (MVP in 6 months):**
Focus on Phases 1-4 only with a larger team (5-6 developers)

---

## Security & Compliance

### Security Measures

1. **Authentication & Authorization**
   - JWT tokens with short expiration
   - Refresh token rotation
   - Role-based access control (RBAC)
   - Multi-factor authentication (Phase 2)
   - Session management and logout

2. **Data Protection**
   - HTTPS/TLS encryption in transit
   - Database encryption at rest
   - PCI DSS compliance for payment data (via Stripe)
   - Secure password hashing (bcrypt)
   - Input validation and sanitization

3. **API Security**
   - Rate limiting
   - CORS configuration
   - API key authentication for integrations
   - Request signing for webhooks
   - SQL injection prevention (parameterized queries)

4. **File Upload Security**
   - File type validation
   - Virus scanning
   - Size limits
   - Secure file storage (S3)
   - Pre-signed URL access control

5. **Monitoring & Logging**
   - Audit logs for sensitive operations
   - Error tracking (Sentry)
   - Access logs
   - Failed login attempt tracking
   - Security event alerts

### Compliance Requirements

1. **Data Privacy**
   - GDPR compliance (if serving EU customers)
   - CCPA compliance (California)
   - Data retention policies
   - Right to deletion
   - Data export functionality

2. **Payment Compliance**
   - PCI DSS Level 1 (via Stripe)
   - Never store credit card numbers
   - Tokenization for saved payment methods
   - Secure payment processing

3. **Industry Standards**
   - SOC 2 Type II (long-term goal)
   - Regular security audits
   - Penetration testing
   - Vulnerability scanning

---

## Cost Estimate

### Development Costs (12-month timeline)

**Team Costs (estimated):**
- Senior developers: 2 × $120K = $240K
- Mid-level developers: 2 × $90K = $180K
- UI/UX Designer: $80K (full-time) or $40K (part-time)
- QA Engineer: $70K
- DevOps: $60K (part-time)
- Project Manager: $50K (part-time)

**Total Development: ~$600K - $700K/year**

### Infrastructure & API Costs (Monthly)

**Heroku:**
- Web dynos (Performance tier): $250/month (4 dynos)
- Worker dynos: $125/month (2 workers)
- PostgreSQL (Standard tier): $200/month
- Redis (Premium 0): $30/month
- Total Heroku: ~$605/month

**APIs & Services:**
- Stripe: Transaction-based (2.9% + $0.30)
- Twilio SMS: $500/month (estimated usage)
- SendGrid: $90/month (100K emails)
- Google Maps: $200/month (within free tier initially)
- AWS S3: $50/month
- Sentry: $80/month
- Total APIs: ~$920/month

**Total Infrastructure: ~$1,525/month (~$18,300/year)**

### Total First Year Cost Estimate
- Development: $600K - $700K
- Infrastructure: $18K
- Contingency (20%): $124K
- **Total: $742K - $842K**

### Ongoing Costs (Year 2+)
- Maintenance & updates: $200K/year (2-3 developers)
- Infrastructure: $25K/year (scales with usage)
- **Total: ~$225K/year**

---

## Next Steps

### Immediate Actions

1. **Finalize Requirements**
   - Review this plan with stakeholders
   - Prioritize features for MVP
   - Define success criteria

2. **Team Assembly**
   - Hire or assign development team
   - Set up project management tools (Jira, Linear, etc.)
   - Establish communication channels

3. **Infrastructure Setup**
   - Create Heroku account and staging/production apps
   - Set up GitHub repository
   - Configure CI/CD pipeline
   - Register API accounts (Stripe, Twilio, SendGrid, etc.)

4. **Design Phase**
   - Create wireframes and mockups
   - Design system and component library
   - Brand integration (Surv logo, colors, typography)
   - User flow diagrams

5. **Development Environment**
   - Set up local development environments
   - Configure database schemas
   - Create initial project structure
   - Set up testing frameworks

### Week 1 Deliverables

1. Project repository created
2. Basic FastAPI backend running
3. React frontend scaffolded
4. Database schema designed
5. Authentication system implemented
6. First deployment to Heroku staging

---

## Conclusion

This plan provides a complete roadmap for building Surv as a HouseCall Pro alternative. The phased approach allows for iterative development with working software at each stage. The technology stack (React, Python, Heroku) provides a solid foundation that can scale as the business grows.

**Key Success Factors:**
- Start with core features (Phase 1-2) to get working software quickly
- Prioritize user feedback and iteration
- Maintain code quality and test coverage
- Plan for scalability from the beginning
- Keep security and compliance top of mind

The estimated 12-month timeline for full feature parity is realistic with a properly sized team. An MVP could be delivered in 3-4 months focusing on core scheduling, CRM, and invoicing features.

---

*Document prepared for Surv Field Service Management Platform*  
*Last updated: October 16, 2025*

